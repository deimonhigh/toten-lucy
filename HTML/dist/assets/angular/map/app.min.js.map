{"version":3,"names":[],"mappings":"","sources":["app.js"],"sourcesContent":["(function () {\r\n  'use strict';\r\n\r\n  angular.module('appToten', [\r\n    \"ui.router\",\r\n    \"ngLocale\",\r\n    \"LocalStorageModule\",\r\n    \"angular-loading-bar\",\r\n    \"ngAnimate\",\r\n    \"webcam\"\r\n  ]);\r\n\r\n  angular.module(\"appToten\").run(runApp);\r\n\r\n  runApp.$inject = ['$rootScope', '$sce', 'cfpLoadingBar', 'apiService', '$state', '$timeout', 'localStorageService', '$transitions'];\r\n\r\n  function runApp($rootScope, $sce, cfpLoadingBar, apiService, $state, $timeout, localStorageService, $transitions) {\r\n    var root = $rootScope;\r\n    root.inicio = true;\r\n    root.foto = false;\r\n\r\n    //region Tema\r\n    var colorDefault = \"#FF5B10\";\r\n    root.temaStorage = apiService.getStorage('tema');\r\n    if (root.temaStorage) {\r\n      colorDefault = root.temaStorage.cor;\r\n    }\r\n    var tema = \"header .logo:before, .btn, .categorias article .collumn .destaque .price, .categorias article h2:after, .produtos .filterRight li a:hover, .produtos .filterRight li a.active, header .meuCarrinho .img .notification, #loading-bar .bar, header ul li.active button, .carrinho .total div.cifra, .foto .closeModal{background: DEFAULTCOLOR}.home article h2, .produtos .listagem li .outer .total,.produto .infos .total,.carrinho .tableHolder table tbody tr td .preco,.choiceButton span:after,.cadastro .form-group label.required:after,.pagamento .obrigado h3,.pagamento .blocos ul li,.pagamento .blocos ul li .parcelas b,.pagamento .finalizacao h3,.pagamento .resumoCompra .tableHolder table tbody tr td span strong, .pagamento .resumoCompra .tableHolder table tbody tr td .preco, .pagamento .resumoCompra .tableHolder table tbody tr td:nth-child(1),.pagamento .resumoCompra .total div.number,.pagamento .resumoCompra h2,.pagamento .loginVendedor h3,.pagamento .loginVendedor .formField .input-group-addon {color: DEFAULTCOLOR}.carrinho .total div.field .btn.white, .carrinho .total div.field .number, .carrinho .total div.field ul li b{color:DEFAULTCOLOR}\";\r\n    root.tema = tema.replace(/(DEFAULTCOLOR)/g, colorDefault);\r\n\r\n    root.$on('temaLoaded', function () {\r\n      root.temaStorage = apiService.getStorage('tema');\r\n      root.tema = tema.replace(/(DEFAULTCOLOR)/g, root.temaStorage.cor);\r\n    });\r\n    //endregion\r\n\r\n    root.openFoto = function () {\r\n      root.foto = true;\r\n    };\r\n\r\n//    apiService.delStorage('carrinho');\r\n\r\n    root.itensCarrinho = apiService.getStorage('carrinho') ? apiService.getStorage('carrinho').length : 0;\r\n\r\n    root.$watch(function () {\r\n      return localStorageService.get('carrinho');\r\n    }, function (newVal) {\r\n      if (newVal) {\r\n        root.itensCarrinho = JSON.parse(atob(newVal)).length;\r\n      }\r\n    });\r\n\r\n    var config = function (email) {\r\n      if (!apiService.getStorage('auth')) {\r\n        config();\r\n        return;\r\n      }\r\n\r\n      var dados = {\r\n        \"email\": email\r\n      };\r\n\r\n      apiService\r\n        .post('config', dados)\r\n        .then(function (res) {\r\n          apiService.setStorage('tema', res.result);\r\n          configGeral();\r\n        }, function () {\r\n          configGeral();\r\n        });\r\n    };\r\n    var configGeral = function () {\r\n      var send = {\r\n        id: 1\r\n      };\r\n      \r\n      apiService\r\n        .post('config', send)\r\n        .then(function (res) {\r\n          var tema = apiService.getStorage('tema');\r\n          if (!tema) {\r\n            tema = {};\r\n          }\r\n\r\n          var temaSalvar = res.result;\r\n          temaSalvar.banner = tema ? tema.banner : null;\r\n          temaSalvar.produto_id = tema ? tema.produto_id : null;\r\n          temaSalvar.listaPreco = tema ? tema.listaPreco : null;\r\n          temaSalvar.cor = tema ? tema.cor : null;\r\n          temaSalvar.empresa = tema ? tema.empresa : null;\r\n\r\n          apiService.setStorage('tema', temaSalvar);\r\n          root.$broadcast('temaLoaded');\r\n        }, function (err) {\r\n        });\r\n\r\n    };\r\n\r\n    var auth = apiService.getStorage('auth');\r\n    if (auth) {\r\n      config(auth.email);\r\n    }\r\n\r\n    //region Loading\r\n    root.angularNotLoaded = true;\r\n\r\n    root.$on('loading:progress', function () {\r\n      root.loadingData = true;\r\n    });\r\n\r\n    root.$on('loading:finish', function () {\r\n      root.loadingData = false;\r\n    });\r\n    //endregion\r\n\r\n    //region Utils\r\n    root.trustResource = function (html) {\r\n      return $sce.trustAsHtml(html);\r\n    };\r\n\r\n    root.trustUrl = function (url) {\r\n      return $sce.trustAsResourceUrl(url);\r\n    };\r\n    //endregion\r\n\r\n    //region Transitions\r\n    $transitions.onStart({}, function ($transition) {\r\n      var name = $transition.$to().name;\r\n      var auth = apiService.getStorage('auth');\r\n\r\n      if (name == 'login') {\r\n        if (auth) {\r\n          $timeout(function () { $state.go('home'); });\r\n        }\r\n      } else {\r\n        if (!auth) {\r\n          $timeout(function () { $state.go('login'); });\r\n        }\r\n      }\r\n      cfpLoadingBar.start();\r\n    });\r\n\r\n    $transitions.onSuccess({}, function ($transition) {\r\n      var name = $transition.$to().name;\r\n\r\n      root.inicio = [\"login\", \"home\"].indexOf(name) > -1;\r\n\r\n      cfpLoadingBar.complete();\r\n    });\r\n    //endregion\r\n  }\r\n\r\n})();\r\n\r\n"],"file":"../app.min.js"}