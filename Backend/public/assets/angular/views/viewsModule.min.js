!function(o){"use strict";function e(o,e,t,r){var a=e;o.login=function(o){t.token(o).then(function(e){e.email=o.user,t.setStorage("auth",e),n(o.user)},function(){alert("Usuário ou senha inválidos.")})};var n=function(o){if(!t.getStorage("auth"))return void n();var e={email:o};t.post("config",e).then(function(o){t.setStorage("tema",o.result),c()},function(){c()})},c=function(){var o={id:1};t.post("config",o).then(function(o){var e=t.getStorage("tema");e||(e={});var n=o.result;n.banner=e?e.banner:null,n.produto_id=e?e.produto_id:null,n.listaPreco=e?e.listaPreco:null,n.cor=e?e.cor:null,n.empresa=e?e.empresa:null,t.setStorage("tema",n),a.$broadcast("temaLoaded"),r.go("home")},function(o){})}}o.module("appToten").controller("loginController",e),e.$inject=["$scope","$rootScope","apiService","$state"]}(angular),function(o){"use strict";function e(){}o.module("appToten").controller("homeController",e),e.$inject=[]}(angular),function(o){"use strict";function e(e,t,r,a){var n=e,c=t;n.totalProdutosFrete=0,n.totalProdutos=0,n.cep="",n.result={show:!1},n.listaCompras=r.getStorage("carrinho")||[];var i=function(){n.totalProdutos=n.listaCompras.reduce(function(o,e){return o+e.preco*e.qnt},0),n.result.show?(n.totalProdutosFrete=o.copy(n.totalProdutos),n.result.show=!1):n.totalProdutosFrete=o.copy(n.totalProdutos)};n.removerItem=function(o){n.listaCompras=n.listaCompras.filter(function(e){return e.codigobarras!=o.codigobarras}),r.setStorage("carrinho",n.listaCompras),i()},n.calcTotalItem=function(o){0!==o.qnt.length&&0!==o.qnt||(o.qnt=0,n.removerItem(o)),i()},n.minus=function(o){o.qnt-1<0?o.qnt=0:o.qnt-=1,0==o.qnt&&a(function(){n.removerItem(o)}),d(o,o.qnt),i()},n.more=function(o){o.qnt+=1,d(o,o.qnt),i()};var d=function(o,e){n.listaCompras.filter(function(e){return e.codigobarras==o.codigobarras}).length>0?(n.carrinho=n.listaCompras.map(function(o){return o.codigobarras&&(o.qnt=e),o}),r.setStorage("carrinho",n.listaCompras)):(o.qnt=e,n.listaCompras.push(o),r.setStorage("carrinho",n.listaCompras))};n.limparCarrinho=function(){r.delStorage("carrinho"),c.itensCarrinho=0,n.listaCompras=[],i()},n.calcularFrete=function(){r.cep(n.cep).then(function(o){n.result.local=o.uf+" - "+o.localidade;var e={cep:parseInt(n.cep),peso:n.listaCompras.reduce(function(o,e){return o+parseFloat(e.peso)},0)};s(e)},function(){alert("CEP não encontrado em nossa base.")})};var s=function(e){r.post("frete",e).then(function(e){n.result.valor=e.result.valor,n.result.prazo=e.result.prazo,n.result.show=!0,n.totalProdutosFrete=o.copy(n.totalProdutos)+parseFloat(e.result.valor)},function(){alert("CEP não encontrado em nossa base.")})};i()}o.module("appToten").controller("carrinhoController",e),e.$inject=["$scope","$rootScope","apiService","$timeout"]}(angular),function(o){"use strict";function e(e,t,r){var a=e,n=t;a.hideButtonComprovante=!1;var c=null;a.bandeiras=[{id:"Visa",descricao:"Visa"},{id:"Mastercard",descricao:"Mastercard"},{id:"Hipercard",descricao:"Hipercard"},{id:"American Express",descricao:"American Express"},{id:"Diners",descricao:"Diners"},{id:"Elo",descricao:"Elo"}];var i={bandeira:null,codigo:null};a.comprovantes=[o.copy(i)],a.removeItem=function(o){a.comprovantes=a.comprovantes.filter(function(e){return e.$$hashKey!=o.$$hashKey}),a.hideButtonComprovante=a.comprovantes.length>4},a.addComprovante=function(){a.comprovantes.length<5&&a.comprovantes.push(o.copy(i)),a.hideButtonComprovante=a.comprovantes.length>4},a.closeModal=function(){r.setStorage("comprovanteCodigos",a.comprovantes),a.comprovantes=[o.copy(i)],n.foto=!1,a.confirmFoto=!1,n.$broadcast("confirmarImg")},a.okFoto=function(){a.confirmFoto=!0},a.notOkFoto=function(){a.confirmFoto=!1},a.patOpts={x:0,y:0,w:600,h:540},a.channel={},a.onError=function(o){console.log(o)},a.onSuccess=function(){c=a.channel.video,a.$apply(function(){a.patOpts.w=c.width,a.patOpts.h=c.height})},a.makeSnapshot=function(){if(c){var o=document.querySelector("#snapshot");if(!o)return;var e=o.getContext("2d"),t=d(a.patOpts.x,a.patOpts.y,a.patOpts.w,a.patOpts.h);e.putImageData(t,0,0),a.confirmFoto=!0,a.imgResponse=o.toDataURL(),r.setStorage("comprovante",a.imgResponse)}};var d=function(o,e,t,r){var a=document.createElement("canvas");a.width=c.width,a.height=c.height;var n=a.getContext("2d");return n.drawImage(c,0,0,c.width,c.height),n.getImageData(o,e,t,r)}}o.module("appToten").controller("fotoController",e),e.$inject=["$scope","$rootScope","apiService"]}(angular),function(o){"use strict";function e(e,t,r,a,n,c){var i=e,d=t,s={id:null,documento:null,nome:null,telefone:null,celular:null,enderecos:[]};i.dados={},i.dados.enderecoCerto=!0,i.dados.sexo="M",i.dados.outro={},i.estados=cidadesEstados.estados.map(function(o){return{sigla:o.sigla,nome:o.nome}}),i.$watch(function(o){return o.dados.uf},function(o){o&&i.procuraCidades(o)}),i.procuraCidades=function(o){i.cidades=cidadesEstados.estados.filter(function(e){return e.sigla===o.sigla})[0].cidades.map(function(o){return{nome:o,cidade:a.latinize(o.toUpperCase())}}),d.$broadcast("cidadeLoaded")},i.$watch(function(o){return o.dados.outro.uf},function(o){o&&i.procuraCidadesOutro(o)}),i.procuraCidadesOutro=function(o){i.cidadesOutro=cidadesEstados.estados.filter(function(e){return e.sigla===o.sigla})[0].cidades.map(function(o){return{nome:o,cidade:a.latinize(o.toUpperCase())}}),d.$broadcast("cidadeLoadedOutro")},i.$on("cidadeLoaded",function(){if(i.dados.cidadeTemp){var o=n("filter")(i.cidades,{cidade:a.latinize(i.dados.cidadeTemp).toUpperCase()},!0);i.dados.cidade=o&&o[0]?o[0]:{},delete i.dados.cidadeTemp}}),i.$on("cidadeLoadedOutro",function(){if(i.dados.outro.cidadeTempOutro){var o=n("filter")(i.cidadesOutro,{cidade:a.latinize(i.dados.outro.cidadeTempOutro).toUpperCase()},!0);i.dados.outro.cidade=o&&o[0]?o[0]:{},delete i.dados.outro.cidadeTempOutro}}),i.procurarCliente=function(o){!o||o.length<11||r.procurar("clientes",o).then(function(o){i.dados.documento=o.result.documento,i.dados.nome=o.result.nome,i.dados.telefone=o.result.telefone,i.dados.celular=o.result.celular,i.dados.id=o.result.id,i.dados.sexo=o.result.sexo,i.dados.email=o.result.email,1==o.result.enderecos.length?(i.dados.enderecoCerto=!0,i.dados.cep=o.result.enderecos[0].cep,i.dados.numero=o.result.enderecos[0].numero,i.dados.endereco=o.result.enderecos[0].endereco,i.dados.bairro=o.result.enderecos[0].bairro,i.dados.uf=n("filter")(i.estados,{sigla:o.result.enderecos[0].uf.toUpperCase()},!0)[0],i.dados.cidadeTemp=o.result.enderecos[0].cidade):(i.dados.enderecoCerto=!1,o.result.enderecos.map(function(o){1==o.enderecooriginal?(i.dados.outro.cep=o.cep,i.dados.outro.numero=o.numero,i.dados.outro.endereco=o.endereco,i.dados.outro.bairro=o.bairro,i.dados.outro.uf=n("filter")(i.estados,{sigla:o.uf.toUpperCase()},!0)[0],i.dados.outro.cidadeTempOutro=o.cidade):(i.dados.cep=o.cep,i.dados.numero=o.numero,i.dados.endereco=o.endereco,i.dados.bairro=o.bairro,i.dados.uf=n("filter")(i.estados,{sigla:o.uf.toUpperCase()},!0)[0],i.dados.cidadeTemp=o.cidade)}))},function(o){})},i.salvarDados=function(){var e=o.copy(i.dados);s.enderecos=[],s.id=e.id,s.documento=e.documento,s.nome=e.nome,s.telefone=e.telefone,s.celular=e.celular,s.email=e.email,s.sexo=e.sexo;var t={cep:e.cep,endereco:e.endereco,numero:e.numero,bairro:e.bairro,uf:e.uf.sigla,cidade:e.cidade.nome,enderecoOriginal:e.enderecoCerto};if(s.enderecos.push(t),!e.enderecoCerto){var a={cep:e.outro.cep,endereco:e.outro.endereco,numero:e.outro.numero,bairro:e.outro.bairro,uf:e.outro.uf.sigla,cidade:e.outro.cidade.nome,enderecoOriginal:!e.enderecoCerto};s.enderecos.push(a)}r.post("clientes/save",s).then(function(o){r.setStorage("cliente",o.result),c.go("pagamento")},function(o){})};var u=function(){i.dados.endereco="",i.dados.bairro="",i.dados.uf="",delete i.dados.cidadeTemp},l=function(){i.dados.outro.endereco="",i.dados.outro.bairro="",i.dados.outro.uf="",delete i.dados.outro.cidadeTempOutro};i.procuraCep=function(o){r.cep(o).then(function(o){u(),i.dados.endereco=o.logradouro,i.dados.bairro=o.bairro,i.dados.uf=n("filter")(i.estados,{sigla:o.uf},!0)[0],i.dados.cidadeTemp=o.localidade})},i.procuraOutroCep=function(o){r.cep(o).then(function(o){l(),i.dados.outro.endereco=o.logradouro,i.dados.outro.bairro=o.bairro,i.dados.outro.uf=n("filter")(i.estados,{sigla:o.uf},!0)[0],i.dados.outro.cidadeTempOutro=o.localidade})}}o.module("appToten").controller("cadastroController",e),e.$inject=["$scope","$rootScope","apiService","latinizeService","$filter","$state"]}(angular),function(o){"use strict";function e(o,e,t,r,a,n){var c=o,i=e;if(!r.categoria)return void a.go("categorias");c.maxParcelas=i.temaStorage["parcela"+i.temaStorage.max_parcelas],c.menuActive=r.categoria,c.loading=!1,c.categorias=t.getStorage("categorias"),c.produtoActive=n("filter")(c.categorias,{id:parseInt(c.menuActive)},!0)[0].descricao,c.produtos=[];var d=c.categorias.filter(function(o){return o.id==r.categoria})[0];if(d.categorias){var s=d.categorias.map(function(o){return o.codigocategoria}),u={itens:s};t.post("produtos/filtro",u).then(function(o){c.loading=!0,c.produtos=o.result.filter(function(o){return o["preco"+i.temaStorage.listaPreco]>0}).map(function(o){return o.preco=o["preco"+i.temaStorage.listaPreco],o.precopromocao=o["precopromocao"+i.temaStorage.listaPreco],0==parseFloat(o.precopromocao)?o.comJuros=(parseFloat(o.preco)+parseFloat(o.preco)*parseFloat(c.maxParcelas)/100).toFixed(2)/parseInt(i.temaStorage.max_parcelas):o.comJuros=(parseFloat(o.precopromocao)+parseFloat(o.precopromocao)*parseFloat(c.maxParcelas)/100).toFixed(2)/parseInt(i.temaStorage.max_parcelas),o})})}}o.module("appToten").controller("produtosController",e),e.$inject=["$scope","$rootScope","apiService","$stateParams","$state","$filter"]}(angular),function(o){"use strict";function e(o,e,t,r,a){var n=o,c=e;n.qnt=1,n.produtosRelacionados=[],n.carrinho=t.getStorage("carrinho")||[],n.produto={},n.temasItem=t.getStorage("tema"),n.maxParcelas=c.temaStorage["parcela"+c.temaStorage.max_parcelas],t.get("produtos/"+a.id).then(function(o){n.produto=o.result,n.produto.preco=n.produto["preco"+c.temaStorage.listaPreco],n.produto.precopromocao=n.produto["precopromocao"+c.temaStorage.listaPreco],n.imagemGrande=n.produto.imagens[0],0==parseFloat(n.produto.precopromocao)?(n.produto.comJuros=(parseFloat(n.produto.preco)+parseFloat(n.produto.preco)*parseFloat(n.maxParcelas)/100).toFixed(2)/parseInt(c.temaStorage.max_parcelas),n.produto.semJuros=(parseFloat(n.produto.preco)+parseFloat(n.produto.preco)*parseFloat(c.temaStorage.parcela0)/100).toFixed(2)):(n.produto.comJuros=(parseFloat(n.produto.precopromocao)+parseFloat(n.produto.precopromocao)*parseFloat(n.maxParcelas)/100).toFixed(2)/parseInt(c.temaStorage.max_parcelas),n.produto.semJuros=(parseFloat(n.produto.precopromocao)+parseFloat(n.produto.precopromocao)*parseFloat(c.temaStorage.parcela0)/100).toFixed(2)),t.post("produtos/relacionados",{produtocodigo:n.produto.codigoproduto}).then(function(o){n.produtosRelacionados=o.result},function(o){alert(o.error)})},function(o){alert(o.error)}),n.minus=function(){n.qnt-1<0?n.qnt=0:n.qnt-=1,0==n.qnt&&n.removerItem(item)},n.more=function(){n.qnt+=1},n.selectColor=function(o){n.cores.map(function(o){o.selected=!1}),o.selected=!0},n.changeImg=function(o){n.imagemGrande=o},n.addCarrinho=function(o){n.carrinho.filter(function(e){return e.codigobarras==o.codigobarras}).length>0?(n.carrinho=n.carrinho.map(function(o){return o.codigobarras&&(o.qnt=n.qnt),o}),t.setStorage("carrinho",n.carrinho)):(o.qnt=n.qnt,n.carrinho.push(o),t.setStorage("carrinho",n.carrinho)),r.go("carrinho")}}o.module("appToten").controller("produtoController",e),e.$inject=["$scope","$rootScope","apiService","$state","$stateParams"]}(angular),function(o){"use strict";function e(o,e,t,r,a){var n=o,c=e;n.dadosVendedor={},n.formaPagamento="",n.editarPagamentoFlag=!1,n.cliente=t.getStorage("cliente"),n.formaPagamentoStorage=t.getStorage("formaPagamento"),n.comprovante=t.getStorage("comprovante"),n.frete=t.getStorage("frete"),n.totalCarrinho=0,n.totalCarrinhoFrete=0;n.listaCompras=t.getStorage("carrinho")||[];var i=function(){return n.listaCompras.reduce(function(o,e){return o+e.preco*e.qnt},0)};n.totalCarrinho=i();n.idPedido="SF."+function(o,e,t){return Array(e-String(o).length+1).join(t||"0")+o}(n.cliente.idPedido,13).replace(/^(\d{4})(\d{4})(\d+)(\d{2})/,"$1.$2.$3-$4"),n.validarVendedor=function(){var o={};t.delStorage("comprovante"),o.identificacao=n.dadosVendedor.identificacao,o.senha=n.dadosVendedor.senha,t.post("vendedores/validate",o).then(function(o){r.go("finalizacao"),c.openFoto()},function(o){alert(o.error)})},n.limparSessao=function(){t.delStorage("comprovante"),t.delStorage("cliente"),t.delStorage("carrinho"),c.itensCarrinho=0},n.editarPagamento=function(){n.editarPagamentoFlag=!n.editarPagamentoFlag,t.setStorage("formaPagamento",n.formaPagamento),n.editarPagamentoFlag&&n.formaPagamento.total&&a(function(){n.totalCarrinho=n.formaPagamento.total;var o=0;n.frete&&(o=parseFloat(n.frete.valor)),n.totalCarrinhoFrete=n.formaPagamento.total+o})};var d=function(o){t.post("frete",o).then(function(e){t.setStorage("frete",e.result),n.frete=e.result,n.totalCarrinhoFrete=o.total+parseFloat(e.result.valor)})};n.$on("confirmarImg",function(){var o=t.getStorage("formaPagamento");n.comprovante=t.getStorage("comprovante");var e=t.getStorage("comprovanteCodigos"),r=t.getStorage("auth");n.cliente=t.getStorage("cliente");var a={};a.idcliente=n.cliente.id,a.email=r.email,a.frete=n.frete.valor,a.prazo=n.frete.prazo,a.total=n.formaPagamentoStorage.total,a.totalSemJuros=n.listaCompras.reduce(function(o,e){return o+e.preco*e.qnt},0),a.idPedido=n.cliente.idPedido,a.img=n.comprovante,a.produtos=n.listaCompras.map(function(o){return{produto_id:o.id,codigoproduto:o.codigoproduto,qnt:o.qnt,preco:o.preco}}),a.comprovantes=e.map(function(o){return{bandeira:o.bandeira.id,codigo:o.codigo}}),a.parcelas=o.parcelas,a.aVista=o.aVista,console.log(a)});var s=n.totalCarrinho+n.totalCarrinho*(c.temaStorage.parcela0/100);n.listaPagamentos=[{index:0,parcelas:0,aVista:!0,descricao:"À vista | R$ "+s.toFixed(2).replace(".",","),total:s}];for(var u=c.temaStorage.max_parcelas,l=1;l<=u;l++){var p=n.totalCarrinho+n.totalCarrinho*(c.temaStorage["parcela"+l]/100),m={index:l+1,parcelas:l,aVista:!1,descricao:"Cartão de crédito | "+l+"x de R$ "+(p/l).toFixed(2).replace(".",","),total:p};0==c.temaStorage["parcela"+l]&&(m.descricao+=" s/ juros"),n.listaPagamentos.push(m)}!function(o){var e={cep:o,peso:n.listaCompras.reduce(function(o,e){return o+parseFloat(e.peso)},0),total:i()};d(e)}(n.cliente.cep)}o.module("appToten").controller("pagamentoController",e),e.$inject=["$scope","$rootScope","apiService","$state","$timeout"]}(angular),function(o){"use strict";function e(o,e,t){var r=o;r.categorias=[],t.get("categorias").then(function(o){t.setStorage("categorias",o.result),r.categorias=o.result})}o.module("appToten").controller("categoriaController",e),e.$inject=["$scope","$rootScope","apiService"]}(angular);
//# sourceMappingURL=../map/views/viewsModule.min.js.map
