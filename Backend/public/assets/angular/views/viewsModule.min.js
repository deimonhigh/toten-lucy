!function(o){"use strict";function e(o,e,t,r){var a=e;o.login=function(o){t.token(o).then(function(o){t.setStorage("auth",o),n()},function(o){console.log(o),alert("Usuário ou senha inválidos.")})};var n=function(){if(!t.getStorage("auth"))return void n();t.get("tema/1").then(function(o){t.setStorage("tema",o.result),a.$broadcast("temaLoaded"),r.go("home")},function(o){alert(o.error)})}}o.module("appToten").controller("loginController",e),e.$inject=["$scope","$rootScope","apiService","$state"]}(angular),function(o){"use strict";function e(o,e,t,r){}o.module("appToten").controller("homeController",e),e.$inject=["$scope","$rootScope","apiService","$timeout"]}(angular),function(o){"use strict";function e(o,e,t,r){var a=o;a.listaCompras=t.getStorage("carrinho")||[];var n=function(){a.totalProdutos=a.listaCompras.reduce(function(o,e){return o+e.preco*e.qnt},0)};a.removerItem=function(o){a.listaCompras=a.listaCompras.filter(function(e){return e.$$hashKey!=o.$$hashKey}),t.setStorage("carrinho",a.listaCompras),n()},a.calcTotalItem=function(o){0!=o.qnt.length&&0!=o.qnt||(o.qnt=0,a.removerItem(o)),n()},a.minus=function(o){o.qnt-1<0?o.qnt=0:o.qnt-=1,0==o.qnt&&a.removerItem(o),i(o,o.qnt),n()},a.more=function(o){o.qnt+=1,i(o,o.qnt),n()};var i=function(o,e){a.listaCompras.filter(function(e){return e.codigobarras==o.codigobarras}).length>0?(a.carrinho=a.listaCompras.map(function(o){return o.codigobarras&&(o.qnt=e),o}),t.setStorage("carrinho",a.listaCompras)):(o.qnt=e,a.listaCompras.push(o),t.setStorage("carrinho",a.listaCompras))};n()}o.module("appToten").controller("carrinhoController",e),e.$inject=["$scope","$rootScope","apiService","$timeout"]}(angular),function(o){"use strict";function e(o,e,t){var r=o,a=e,n=null;r.closeModal=function(){a.$broadcast("confirmarImg"),a.foto=!1,r.confirmFoto=!1},r.okFoto=function(){r.confirmFoto=!0},r.notOkFoto=function(){r.confirmFoto=!1},r.patOpts={x:0,y:0,w:400,h:400},r.channel={},r.onError=function(o){console.log(o)},r.onSuccess=function(){n=r.channel.video,r.$apply(function(){r.patOpts.w=n.width,r.patOpts.h=n.height})},r.makeSnapshot=function(){if(n){var o=document.querySelector("#snapshot");if(!o)return;var e=o.getContext("2d"),a=i(r.patOpts.x,r.patOpts.y,r.patOpts.w,r.patOpts.h);e.putImageData(a,0,0),r.confirmFoto=!0,r.imgResponse=o.toDataURL(),t.setStorage("comprovante",r.imgResponse)}};var i=function(o,e,t,r){var a=document.createElement("canvas");a.width=n.width,a.height=n.height;var i=a.getContext("2d");return i.drawImage(n,0,0,n.width,n.height),i.getImageData(o,e,t,r)}}o.module("appToten").controller("fotoController",e),e.$inject=["$scope","$rootScope","apiService"]}(angular),function(o){"use strict";function e(e,t,r,a,n,i){var c=e,d=t,s={id:null,documento:null,nome:null,telefone:null,celular:null,enderecos:[]};c.dados={},c.dados.enderecoCerto=!0,c.dados.sexo="M",c.dados.outro={},c.estados=cidadesEstados.estados.map(function(o){return{sigla:o.sigla,nome:o.nome}}),c.$watch(function(o){return o.dados.uf},function(o){void 0!=o&&c.procuraCidades(o)}),c.procuraCidades=function(o){c.cidades=cidadesEstados.estados.filter(function(e){return e.sigla===o.sigla})[0].cidades.map(function(o){return{nome:o,cidade:a.latinize(o.toUpperCase())}}),d.$broadcast("cidadeLoaded")},c.$watch(function(o){return o.dados.outro.uf},function(o){void 0!=o&&c.procuraCidadesOutro(o)}),c.procuraCidadesOutro=function(o){c.cidadesOutro=cidadesEstados.estados.filter(function(e){return e.sigla===o.sigla})[0].cidades.map(function(o){return{nome:o,cidade:a.latinize(o.toUpperCase())}}),d.$broadcast("cidadeLoadedOutro")},c.procurarCliente=function(o){!o||o.length<11||r.procurar("clientes",o).then(function(o){c.dados.documento=o.result.documento,c.dados.nome=o.result.nome,c.dados.telefone=o.result.telefone,c.dados.celular=o.result.celular,c.dados.id=o.result.id,c.dados.sexo=o.result.sexo,c.dados.email=o.result.email,1==o.result.enderecos.length?(c.dados.enderecoCerto=!0,c.dados.cep=o.result.enderecos[0].cep,c.dados.numero=o.result.enderecos[0].numero,c.dados.endereco=o.result.enderecos[0].endereco,c.dados.bairro=o.result.enderecos[0].bairro,c.dados.uf=n("filter")(c.estados,{sigla:o.result.enderecos[0].uf.toUpperCase()},!0)[0],c.dados.cidadeTemp=o.result.enderecos[0].cidade):(c.dados.enderecoCerto=!1,o.result.enderecos.map(function(o){1==o.enderecooriginal?(c.dados.outro.cep=o.cep,c.dados.outro.numero=o.numero,c.dados.outro.endereco=o.endereco,c.dados.outro.bairro=o.bairro,c.dados.outro.uf=n("filter")(c.estados,{sigla:o.uf.toUpperCase()},!0)[0],c.dados.outro.cidadeTempOutro=o.cidade):(c.dados.cep=o.cep,c.dados.numero=o.numero,c.dados.endereco=o.endereco,c.dados.bairro=o.bairro,c.dados.uf=n("filter")(c.estados,{sigla:o.uf.toUpperCase()},!0)[0],c.dados.cidadeTemp=o.cidade)}))},function(o){})},c.$on("cidadeLoaded",function(){if(c.dados.cidadeTemp){var o=n("filter")(c.cidades,{cidade:a.latinize(c.dados.cidadeTemp).toUpperCase()},!0);c.dados.cidade=o&&o[0]?o[0]:{},delete c.dados.cidadeTemp}}),c.$on("cidadeLoadedOutro",function(){if(c.dados.outro.cidadeTempOutro){var o=n("filter")(c.cidadesOutro,{cidade:a.latinize(c.dados.outro.cidadeTempOutro).toUpperCase()},!0);c.dados.outro.cidade=o&&o[0]?o[0]:{},delete c.dados.outro.cidadeTempOutro}}),c.salvarDados=function(){var e=o.copy(c.dados);s.enderecos=[],s.id=e.id,s.documento=e.documento,s.nome=e.nome,s.telefone=e.telefone,s.celular=e.celular,s.email=e.email,s.sexo=e.sexo;var t={cep:e.cep,endereco:e.endereco,numero:e.numero,bairro:e.bairro,uf:e.uf.sigla,cidade:e.cidade.nome,enderecoOriginal:e.enderecoCerto};if(s.enderecos.push(t),!e.enderecoCerto){var a={cep:e.outro.cep,endereco:e.outro.endereco,numero:e.outro.numero,bairro:e.outro.bairro,uf:e.outro.uf.sigla,cidade:e.outro.cidade.nome,enderecoOriginal:!e.enderecoCerto};s.enderecos.push(a)}r.post("clientes/save",s).then(function(o){r.setStorage("cliente",o.result),i.go("pagamento")},function(o){})}}o.module("appToten").controller("cadastroController",e),e.$inject=["$scope","$rootScope","apiService","latinizeService","$filter","$state"]}(angular),function(o){"use strict";function e(o,e,t,r,a,n){var i=o;if(!r.categoria)return void a.go("categorias");i.menuActive=r.categoria,i.loading=!1,i.categorias=t.getStorage("categorias"),i.produtoActive=n("filter")(i.categorias,{id:parseInt(i.menuActive)},!0)[0].descricao,i.produtos=[];var c=i.categorias.filter(function(o){return o.id==r.categoria})[0];if(c.categorias){var d=c.categorias.map(function(o){return o.codigocategoria}),s={itens:d};t.post("produtos/filtro",s).then(function(o){i.loading=!0,i.produtos=o.result})}}o.module("appToten").controller("produtosController",e),e.$inject=["$scope","$rootScope","apiService","$stateParams","$state","$filter"]}(angular),function(o){"use strict";function e(o,e,t,r,a){var n=o;n.qnt=1,n.produtosRelacionados=[],n.carrinho=t.getStorage("carrinho")||[],n.produto={},n.temasItem=t.getStorage("tema"),t.get("produtos/"+a.id).then(function(o){n.produto=o.result,n.imagemGrande=n.produto.imagens[0],t.post("produtos/relacionados",{produtocodigo:n.produto.codigoproduto}).then(function(o){n.produtosRelacionados=o.result},function(o){alert(o.error)})},function(o){alert(o.error)}),n.minus=function(){n.qnt-1<0?n.qnt=0:n.qnt-=1,0==n.qnt&&n.removerItem(item)},n.more=function(){n.qnt+=1},n.selectColor=function(o){n.cores.map(function(o){o.selected=!1}),o.selected=!0},n.changeImg=function(o){n.imagemGrande=o},n.addCarrinho=function(o){n.carrinho.filter(function(e){return e.codigobarras==o.codigobarras}).length>0?(n.carrinho=n.carrinho.map(function(o){return o.codigobarras&&(o.qnt=n.qnt),o}),t.setStorage("carrinho",n.carrinho)):(o.qnt=n.qnt,n.carrinho.push(o),t.setStorage("carrinho",n.carrinho)),r.go("carrinho")}}o.module("appToten").controller("produtoController",e),e.$inject=["$scope","$rootScope","apiService","$state","$stateParams"]}(angular),function(o){"use strict";function e(o,e,t,r,a){var n=o,i=e;n.dadosVendedor={},n.formaPagamento={},n.editarPagamentoFlag=!1,n.cliente=t.getStorage("cliente"),n.formaPagamentoStorage=t.getStorage("formaPagamento"),n.comprovante=t.getStorage("comprovante");n.listaCompras=t.getStorage("carrinho")||[],n.totalCarrinho=n.listaCompras.reduce(function(o,e){return o+e.preco*e.qnt},0);n.idPedido="SF."+function(o,e,t){return Array(e-String(o).length+1).join(t||"0")+o}(n.cliente.idPedido,13).replace(/^(\d{4})(\d{4})(\d+)(\d{2})/,"$1.$2.$3-$4"),n.validarVendedor=function(){var o={};t.delStorage("comprovante"),o.identificacao=n.dadosVendedor.identificacao,o.senha=n.dadosVendedor.senha,t.post("vendedores/validate",o).then(function(o){r.go("finalizacao"),i.openFoto()},function(o){alert(o.error)})},n.limparSessao=function(){t.delStorage("comprovante"),t.delStorage("cliente"),t.delStorage("carrinho")},n.editarPagamento=function(){n.editarPagamentoFlag=!n.editarPagamentoFlag,t.setStorage("formaPagamento",n.formaPagamento),n.editarPagamentoFlag&&n.formaPagamento.total&&a(function(){n.totalCarrinho=n.formaPagamento.total})},n.$on("confirmarImg",function(){var o=t.getStorage("formaPagamento");n.comprovante=t.getStorage("comprovante"),n.cliente=t.getStorage("cliente");var e={};e.idcliente=n.cliente.id,e.total=n.formaPagamentoStorage.total,e.idPedido=n.cliente.idPedido,e.img=n.comprovante,e.produtos=n.listaCompras.map(function(o){return{produto_id:o.id,codigoproduto:o.codigoproduto,qnt:o.qnt,preco:o.preco}}),e.parcelas=o.parcelas,e.aVista=o.aVista,t.post("pedidos/save",e).then(function(o){},function(o){alert(o.error)})});var c=n.totalCarrinho+n.totalCarrinho*(i.temaStorage.parcela0/100);n.listaPagamentos=[{index:0,parcelas:0,aVista:!0,descricao:"À vista | R$ "+c.toFixed(2).replace(".",","),total:c}];for(var d=1;d<13;d++){var s=n.totalCarrinho+n.totalCarrinho*(i.temaStorage["parcela"+d]/100),u={index:d+1,parcelas:d,aVista:!1,descricao:"Cartão de crédito | "+d+"x de R$ "+(s/d).toFixed(2).replace(".",","),total:s};n.listaPagamentos.push(u)}}o.module("appToten").controller("pagamentoController",e),e.$inject=["$scope","$rootScope","apiService","$state","$timeout"]}(angular),function(o){"use strict";function e(o,e,t){var r=o;r.categorias=[],t.get("categorias").then(function(o){t.setStorage("categorias",o.result),r.categorias=o.result})}o.module("appToten").controller("categoriaController",e),e.$inject=["$scope","$rootScope","apiService"]}(angular);
//# sourceMappingURL=../map/views/viewsModule.min.js.map
